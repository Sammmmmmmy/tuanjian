<!DOCTYPE html>

<head>
        <meta charset="utf-8">
        <title>2-团支部年度工作计划</title>
        <link type="text/css" href="../styles/part1/2.css" rel="stylesheet">
        <link type="text/css" href="../styles/all.css" rel="stylesheet">
</head>

<body>
        <!-- 注册团员名单 -->
        <div>
                <div class="title">
                        <div class="title-circle">
                                <span>2</span>
                        </div>
                        <div class="title-words">
                                <p class="font-1">团支部年度工作计划</p>
                                <p class="font-2">INSTRODUCTION</p>
                        </div>
                </div>


                <table class="table-title" cellspacing="0" cellpadding="0">
                        <tr>
                                <td class="table-title-words">注册团员名单</td>
                        </tr>

                        <tr>
                                <td height="15px"></td>
                        </tr>
                </table>
                <table class="table-else" cellspacing="1" cellpadding="4" id="part1-2-list">
                        <tr>
                                <th>姓名</th>
                                <th>性别</th>
                                <th>民族</th>
                                <th>籍贯</th>
                                <th>出生年月</th>
                                <th>政治面貌</th>
                                <th>入党时间</th>
                                <th>入团时间</th>
                        </tr>
                        <tr>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                        </tr>
                        <tr>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                        </tr>
                        <tr>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                        </tr>
                        <tr>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                        </tr>
                        <tr>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                        </tr>
                        <tr>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                                <td contentEditable="true">1</td>
                        </tr>
                        <tr>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                        </tr>
                        <tr>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                        </tr>
                        <tr>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                        </tr>
                        <tr>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                        </tr>
                        <tr>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                        </tr>
                        <tr>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                        </tr>
                        <tr>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                        </tr>
                        <tr>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                        </tr>
                        <tr>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                        </tr>
                        <tr>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                        </tr>
                        <tr>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                        </tr>
                        <tr>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                        </tr>
                        <tr>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                        </tr>
                        <tr>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                                <td contentEditable="true"></td>
                        </tr>
                </table>
                <div style="width: 100px; margin: auto;">
                        <input type="image" src="../images/add.png"
                                style="width: 100px;height: 100px; margin: auto 0;text-align: center;outline: none;"
                                onclick="addTable()">
                </div>
                <div class="buttons">
                        <button id="submit" onclick="submit()">提交</button>
                </div>
        </div>
</body>
<script type="javascript/text" src="../scripts/jquery.js"></script>
<script>
        var Class = sessionStorage.getItem("class");
        window.onload = function () {
                showList();
        }

        $(window).bind('beforeunload', function () {
                submit();
        });

        function submit() {
                //团员信息array
                var array = [];
                var tb = document.getElementById('part1-2-list');    // table 的 id
                var rows = tb.rows;                           // 获取表格所有行
                for (var i = 1; i < rows.length; i++) {
                        var flag = true;
                        var memItem = {};
                        if (rows[i].cells[0] == "" && rows[i].cells[1] == "" && rows[i].cells[2] == "" && rows[i].cells[3] == "" && rows[i].cells[4] == "" && rows[i].cells[5] == "" && rows[i].cells[6] == "" && rows[i].cells[7] == "") {
                                flag = false;
                        }
                        memItem["memName"] = rows[i].cells[0].innerText;
                        memItem["sex"] = rows[i].cells[1].innerText;
                        memItem["nation"] = rows[i].cells[2].innerText;
                        memItem["nativePlace"] = rows[i].cells[3].innerText;
                        memItem["birthday"] = rows[i].cells[4].innerText;
                        memItem["politicStatus"] = rows[i].cells[5].innerText;
                        memItem["joinPartyDate"] = rows[i].cells[6].innerText;
                        memItem["joinLeaDate"] = rows[i].cells[7].innerText;

                        if (flag) {
                                array.push(memItem);
                        }
                }

                var jsonArray = JSON.stringify(array);

                $.ajax({
                        type: "POST",
                        url: "servlet/part1_2",
                        data: {
                                "flag": 1,
                                "Class": Class,
                                "array": jsonArray
                        },
                        success: function (data, status) {
                                showList();
                        },
                        error: function (data, status) {
                                console.log("出错啦，去找管理员处理把");
                        }
                });

        }

        function showList() {

                $.ajax({
                        type: "POST",
                        url: "servlet/part1_2",
                        data: {
                                "Class": Class,
                                "flag": 0
                        },
                        success: function (data, status) {
                                $("#part1-2-list").html("");
                                var tHead = document.createElement('tr');
                                var thName = document.createElement('th');
                                thName.innerText = "姓名";
                                var thSex = document.createElement('th');
                                thName.innerText = "性别";
                                var thNation = document.createElement('th');
                                thName.innerText = "民族";
                                var thHome = document.createElement('th');
                                thName.innerText = "籍贯";
                                var thBirth = document.createElement('th');
                                thName.innerText = "出生年月";
                                var thPoliticStatus = document.createElement('th');
                                thPoliticStatus.innerText = "政治面貌";
                                var thJoinPartyTime = document.createElement('th');
                                thName.innerText = "入党时间";
                                var thJoinLeaTime = document.createElement('th');
                                thName.innerText = "入团时间";

                                tHead.append(thName);
                                tHead.append(thSex);
                                tHead.append(thNation);
                                tHead.append(thHome);
                                tHead.append(thBirth);
                                tHead.append(thJoinPartyTime);
                                tHead.append(thJoinLeaTime);

                                $("#part1-2-list").append(tHead);


                                for (var i = 0; i < size; i++) {
                                        var trItem = document.createElement('tr');
                                        var tdName = document.createElement('td');
                                        tdName.contentEditable = true;
                                        tdName.innerText = data.array[i].memName;

                                        var tdSex = document.createElement('td');
                                        tdSex.innerText = data.array[i].sex;
                                        tdSex.contentEditable = true;

                                        var tdNation = document.createElement('td');
                                        tdNation.innerText = data.array[i].nation;
                                        tdNation.contentEditable = true;

                                        var tdNativePlace = document.createElement('td');
                                        tdNativePlace.innerText = data.array[i].nativePlace;
                                        tdNativePlace.contentEditable = true;

                                        var tdBirth = document.createElement('td');
                                        tdBirth.innerText = data.array[i].birthday;
                                        tdBirth.contentEditable = true;

                                        var tdPoliticStatus = document.createElement('td');
                                        tdPoliticStatus.innerText = data.array[i].politicStatus;
                                        tdPoliticStatus.contentEditable = true;

                                        var tdJoinPartyTime = document.createElement('td');
                                        tdJoinPartyTime.innerText = data.array[i].joinPartyDate;
                                        tdJoinPartyTime.contentEditable = true;

                                        var tdJoinLeaTime = document.createElement('td');
                                        tdJoinLeaTime.innerText = data.array[i].joinLeaDate;
                                        tdJoinLeaTime.contentEditable = true;

                                        trItem.append(tdName);
                                        trItem.append(tdSex);
                                        trItem.append(tdNation);
                                        trItem.append(tdNativePlace);
                                        trItem.append(tdBirth);
                                        trItem.append(tdPoliticStatus);
                                        trItem.append(tdJoinPartyTime);
                                        trItem.append(tdJoinLeaTime);

                                        $("#part1-2-list").append(trItem);

                                }

                                for (var j = 0; j < 5; j++) {
                                        var newTr = document.createElement("tr");
                                        for (i = 0; i < 8; i++) {
                                                var newTd = document.createElement("td");
                                                newTd.contentEditable = true;
                                                newTr.appendChild(newTd);
                                        }
                                        $("#part1-2-list").append(newTr);
                                }
                        },
                        error: function (data, status) {
                                alert("查询信息出错啦，请联系管理员处理~");
                        }
                });



        }

        function addTable() {
                var newTr = document.createElement("tr");
                for (i = 0; i < 8; i++) {
                        var newTd = document.createElement("td");
                        newTd.contentEditable = true;
                        newTr.appendChild(newTd);
                }
                var part12list = document.getElementById("part1-2-list");
                part12list.appendChild(newTr);
        }

</script>

</html>